import{a as k,b as N}from"./chunk-OKFOSNXN.js";import{A as y,C as f,E as o,F as r,I as O,J as I,L as c,M as T,N as m,P as E,Q as x,R as D,W as R,X as M,Y as j,Z as q,ba as F,i as v,l as P,m as h,v as a,w as d}from"./chunk-N7S2ZSR3.js";var C=class t{constructor(i){this.materialsService=i;this.materialsService.getMaterials().subscribe(e=>{this.materialsData=e})}materialsData;calculateOrder(i){let e=0,l=[];return i.items.forEach(n=>{let s=this.calculateItemCost(n);e+=s,l.push({materialType:n.materialType,category:n.category,subcategory:n.subcategory,quantity:n.quantity,cost:s})}),{totalCost:e,details:l}}calculateItemCost(i){let{materialType:e,category:l,subcategory:n,quantity:s}=i;if(e==="Transport")return(this.materialsData.types.find(u=>u.type==="Transport")?.pricePerKilometer||0)*s;if(e==="Work")return(this.materialsData.types.find(u=>u.type==="Work")?.pricePerDay||0)*s;let _=this.materialsData.types.find(p=>p.type===e);if(!_)return 0;let S=_.categories?.find(p=>p.name===l);return S?e==="Material"?(S.subcategories?.find(b=>b.name===n)?.pricePerSquareMeter||0)*s:e==="Hardware"?(S.subcategories?.find(b=>b.name===n)?.pricePerPiece||0)*s:0:0}static \u0275fac=function(e){return new(e||t)(P(k))};static \u0275prov=v({token:t,factory:t.\u0275fac,providedIn:"root"})};var g=class t{constructor(){}static \u0275fac=function(e){return new(e||t)};static \u0275prov=v({token:t,factory:t.\u0275fac,providedIn:"root"})};function W(t,i){if(t&1&&(o(0,"p"),c(1),r()),t&2){let e=I().$implicit;a(),m("Subcategory: ",e.subcategory,"")}}function $(t,i){if(t&1&&(o(0,"div",3)(1,"h3"),c(2),r(),o(3,"p"),c(4),r(),y(5,W,2,1,"p",1),o(6,"p"),c(7),r(),o(8,"p"),c(9),x(10,"currency"),r()()),t&2){let e=i.$implicit;a(2),T(e.materialType),a(2),m("Category: ",e.category,""),a(),f("ngIf",e.subcategory),a(2),m("Quantity: ",e.quantity,""),a(2),m("Cost: ",D(10,5,e.cost),"")}}function H(t,i){if(t&1&&(o(0,"div")(1,"p"),c(2),x(3,"currency"),r(),y(4,$,11,7,"div",2),r()),t&2){let e=I();a(2),m("Total Cost: ",D(3,2,e.totalCost),""),a(2),f("ngForOf",e.orderDetails)}}function J(t,i){t&1&&(o(0,"div")(1,"p"),c(2,"No calculation performed yet."),r()())}var A=class t{constructor(i,e,l,n){this.orderService=i;this.calculationService=e;this.pdfService=l;this.route=n}order;totalCost=0;orderDetails=[];calculated=!1;ngOnInit(){this.route.queryParams.subscribe(i=>{let e=i.order;e&&(this.order=JSON.parse(e))})}onCalculate(){if(this.order){let i=this.calculationService.calculateOrder(this.order);this.totalCost=i.totalCost,this.orderDetails=i.details,this.calculated=!0}}static \u0275fac=function(e){return new(e||t)(d(N),d(C),d(g),d(F))};static \u0275cmp=h({type:t,selectors:[["app-calculation-result"]],standalone:!0,features:[E],decls:7,vars:2,consts:[[3,"click"],[4,"ngIf"],["class","order-item",4,"ngFor","ngForOf"],[1,"order-item"]],template:function(e,l){e&1&&(o(0,"div")(1,"h2"),c(2,"Calculation Result"),r(),o(3,"button",0),O("click",function(){return l.onCalculate()}),c(4,"Calculate"),r(),y(5,H,5,4,"div",1)(6,J,3,0,"div",1),r()),e&2&&(a(5),f("ngIf",l.calculated),a(),f("ngIf",!l.calculated))},dependencies:[q,R,M,j]})};export{A as CalculationResultComponent};
